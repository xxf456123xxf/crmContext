!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="/assets/",e(0)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.crmContext=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(1),s=e.crmContext=function(){function t(e){r(this,t),this.Xrm=e}return i(t,[{key:"attr",value:function(t){return new a.crmAttr(this.Xrm,t)}},{key:"entity",get:function(){return new a.crmEntity(this.Xrm)}}]),t}();window.crmContext=s},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r){n(this,t),e&&r&&(this.name=r,this.attrname=e.Page.getAttribute(r),this.contname=e.Page.getControl(r),this.crmEntity=new a(e),this.contname||(this.contname=e.Page.ui.tabs.get(r)),this.attrname&&this.contname||this.error("not found "+this.name))}return r(t,[{key:"getValue",value:function(){var t=this.attrname.getValue();return t}},{key:"get",value:function(){if(!this.attrname)return this;var t=this.attrname.getValue();return Array.isArray(t)?t.length>0?t[0]:{}:t}},{key:"val",value:function(t){var e=null;return this.attrname?(e=this.attrname[arguments.length>0?"setValue":"getValue"](t),Array.isArray(e)&&(e=e[0].id),arguments.length>0&&this.mode(),0===arguments.length?e:this):this}},{key:"show",value:function(){return this.contname&&this.contname.setVisible(!0),this}},{key:"hide",value:function(){return this.contname&&this.contname.setVisible(!1),this}},{key:"disabled",value:function e(){var e=1;return this.contname&&(void 0!=arguments[0]&&(e=arguments[0]),this.contname.setDisabled(e)),this}},{key:"change",value:function(t,e){return this.attrname&&("function"==typeof t?(this.attrname.addOnChange(t,!1),e&&this.attrname.fireOnChange()):0===arguments.length&&this.attrname.fireOnChange()),this}},{key:"removechange",value:function(t){return this.attrname&&this.attrname.removeOnChange(t),this}},{key:"required",value:function(t){return this.attrname&&this.attrname.setRequiredLevel(t?"required":"none"),this}},{key:"mode",value:function(t){if(this.attrname){var e="always";switch(t){case 1:e="always";break;case 0:e="never"}this.attrname.setSubmitMode(e)}return this}},{key:"default",value:function(t){return 1==this.crmEntity.type()&&this.val(t),this}},{key:"user",value:function(){if(this.attrname){var t={};t.id=this.crmEntity.userid,t.entityType="systemuser",t.name=this.crmEntity.username,this.val([t])}return this}},{key:"clear",value:function(){return this.attrname&&this.val(null),this}},{key:"focus",value:function(){return this.contname&&this.contname.setFocus(),this}},{key:"type",value:function(t){return new Promise(function(e,n){this.crmEntity.type()==t?e(this):n(this)})}},{key:"error",value:function(t){window.console.error(t)}},{key:"save",value:function(){return this.crmEntity.save()}}]),t}();e.crmAttr=i;var a=e.crmEntity=function(){function t(e){n(this,t),this.Xrm=e}return r(t,[{key:"save",value:function(){return this.Xrm.Page.data.save()}},{key:"refRibbon",value:function(){return this.Xrm.Page.ui.refreshRibbon()}},{key:"refresh",value:function(){this.Xrm.Utility.openEntityForm(this.Xrm.Page.data.entity.getEntityName(),this.Xrm.Page.data.entity.getId())}},{key:"disabledAll",value:function(t){this.Controls(this.Xrm.Page.ui.controls,"disabled",t)}},{key:"disabled",value:function(t,e){this.Tabs(t,"disabled",e)}},{key:"show",value:function(t){this.Tabs(t,"show")}},{key:"hide",value:function(t){this.Tabs(t,"hide")}},{key:"Tabs",value:function(t,e,n){var r=this,a=this.Xrm,s=[].concat(t);t.forEach(function(t){var o=a.Page.ui.tabs.get(t);if(o){var u=s.indexOf(t);if(u>-1&&s.splice(u,1),"hide"===e||"show"===e){var c=(new i)[e].bind({contname:o});c(n)}else r.Sections(o.sections.get(),e,n)}}),this.Sections(s,e,n)}},{key:"Sections",value:function(t,e,n){var r=this,i=[].concat(t);t.forEach(function(t){var a=t;if("string"==typeof a&&(a=r.getSections(t)||a),"string"!=typeof a){var s=i.indexOf(t);s>-1&&i.splice(s,1),r.Controls(a.controls.get(),e,n)}}),this.Controls(i,e,n)}},{key:"Controls",value:function(t,e,n){var r=this;t.forEach(function(t){if("string"==typeof t)new i(r.Xrm,t)[e](n);else{var a=t.getControlType();if("iframe"!=a&&"webresource"!=a&&"subgrid"!=a){var s=(new i)[e].bind({contname:t});s(n)}}})}},{key:"getSections",value:function(t){var e=this.Xrm.Page.ui.tabs.get(),n=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value,u=o.sections.getFirst(function(e){return e.getName()==t});if(u)return u}}catch(c){r=!0,i=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw i}}return null}},{key:"id",get:function(){return this.Xrm.Page.data.entity.getId()}},{key:"name",get:function(){return this.Xrm.Page.data.entity.getEntityName()}},{key:"type",get:function(){return this.Xrm.Page.ui.getFormType()}},{key:"userid",get:function(){return this.Xrm.Page.context.getUserId()}},{key:"username",get:function(){return this.Xrm.Page.context.getUserName()}},{key:"isowner",get:function(){return this.userid==new i(this.Xrm,"ownerid").val()}}]),t}()}]);
//# sourceMappingURL=crmApp.js.map