{"version":3,"sources":["webpack:///webpack/bootstrap 761f51c46aa0b75ee367","webpack:///./src/crmApp.js","webpack:///./src/common/crmEntity.js"],"names":[],"mappings":"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","file":"crmApp.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/assets/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 761f51c46aa0b75ee367\n **/","import { crmEntity, crmAttr } from './common/crmEntity.js';\r\nexport class crmContext {\r\n    constructor(Xrm, pars) {\r\n        this.Xrm = Xrm;\r\n        this.pars = pars || {};\r\n    }\r\n    attr(name) {\r\n        return new crmAttr(this.Xrm, name);\r\n    }\r\n    get entity() {\r\n        return new crmEntity(this.Xrm, this.pars.Sys)\r\n    }\r\n}\r\nwindow.crmContext = crmContext;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/crmApp.js\n **/","export class crmAttr {\r\n    constructor(Xrm, name) {\r\n        if (!Xrm || !name) {\r\n            return;\r\n        }\r\n        this.Xrm = Xrm;\r\n        this.name = name;\r\n        this.attrname = Xrm.Page.getAttribute(name);\r\n        this.contname = Xrm.Page.getControl(name);\r\n        this.crmEntity = new crmEntity(Xrm);\r\n        if (!this.contname) {\r\n            this.contname = Xrm.Page.ui.tabs.get(name);\r\n        }\r\n        if (!this.attrname && !this.contname) {\r\n            this.error('not found ' + this.name);\r\n        }\r\n    }\r\n        //获取字段值 crm方法\r\n    getValue() {\r\n        const getval = this.attrname.getValue();\r\n        return getval;\r\n    }\r\n        //获取字段值 Lookup返回第一个值\r\n    get() {\r\n        if (!this.attrname) {\r\n            return this;\r\n        }\r\n        const getval = this.attrname.getValue();\r\n        if (Array.isArray(getval)) {\r\n            return getval.length > 0 ? getval[0] : {}\r\n        }\r\n        return getval;\r\n    }\r\n        //设置和获取值  lookup获取Id\r\n    val(v) {\r\n        let obj = null;\r\n        if (!this.attrname) {\r\n            return this;\r\n        }\r\n        obj = this.attrname[arguments.length > 0 ? 'setValue' : 'getValue'](v);\r\n        if (Array.isArray(obj)) {\r\n            obj = obj[0].id;\r\n        }\r\n        if (arguments.length > 0) {\r\n            this.mode();\r\n        }\r\n        return arguments.length === 0 ? obj : this;\r\n    }\r\n        //显示\r\n    show() {\r\n        if (this.contname) {\r\n            this.contname.setVisible(!0);\r\n        }\r\n        return this;\r\n    }\r\n        //隐藏\r\n    hide() {\r\n        if (this.contname) {\r\n            this.contname.setVisible(!1);\r\n        }\r\n        return this;\r\n    }\r\n        //禁用\r\n    disabled() {\r\n        let disabled = 1;\r\n        if (this.contname) {\r\n            if (arguments[0] != undefined) {\r\n                disabled = arguments[0];\r\n            }\r\n            this.contname.setDisabled(disabled);\r\n        }\r\n        return this;\r\n    }\r\n        //绑定或触发change\r\n    change(c, a) {\r\n        if (this.attrname) {\r\n            if (typeof(c) == 'function') {\r\n                this.attrname.addOnChange(c, false);\r\n                a && this.attrname.fireOnChange();\r\n            } else if (arguments.length === 0) {\r\n                this.attrname.fireOnChange();\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n        //移除change方法\r\n    removechange(a) {\r\n        if (this.attrname) {\r\n            this.attrname.removeOnChange(a);\r\n        }\r\n        return this;\r\n    }\r\n        //字段必填\r\n    required(a) {\r\n        if (this.attrname) {\r\n            this.attrname.setRequiredLevel(a ? 'required' : 'none');\r\n        }\r\n        return this;\r\n    }\r\n        //提交模式 默认设置成always, 对字段赋值会调用\r\n    mode(m) {\r\n        if (this.attrname) {\r\n            let modestr = 'always';\r\n            switch (m) {\r\n            case 1:\r\n                modestr = 'always';\r\n                break;\r\n            case 0:\r\n                modestr = 'never';\r\n                break;\r\n            default:\r\n                break;\r\n            }\r\n            this.attrname.setSubmitMode(modestr);\r\n        }\r\n        return this;\r\n    }\r\n        // 默认值\r\n    default(val) {\r\n        if (this.crmEntity.type == 1) {\r\n            this.val(val);\r\n        }\r\n        return this;\r\n    }\r\n    //Lookup字段设置当前登录人\r\n    user() {\r\n        if (this.attrname) {\r\n            let toValue = {};\r\n            toValue.id = this.crmEntity.userid;\r\n            toValue.entityType = 'systemuser';\r\n            toValue.name = this.crmEntity.username;\r\n            this.val([toValue]);\r\n        }\r\n        return this;\r\n    }\r\n        //清除字段\r\n    clear() {\r\n        if (this.attrname) {\r\n            this.val(null);\r\n        }\r\n        return this;\r\n    }\r\n        //设置焦点\r\n    focus() {\r\n        if (this.contname) {\r\n            this.contname.setFocus();\r\n        }\r\n        return this;\r\n    }\r\n        // 当前提示类型判断\r\n    type(type) {\r\n        this.crmEntity.type != type && (this.contname = this.attrname = null)\r\n        return this;\r\n    }\r\n    error(message) {\r\n        window.console.error(message);\r\n    }\r\n        //保存\r\n    save() {\r\n        return this.crmEntity.save();\r\n    }\r\n    option(obj, handle, state) {\r\n        var arr = [];\r\n        var value = this.val();\r\n        for (var key in obj) {\r\n            var valArr = [].concat(obj[key]).map(item => {\r\n                return item * 1\r\n            })\r\n            new crmEntity(this.Xrm).Tabs(key, handle, state);\r\n            if (valArr.indexOf(value) > -1) {\r\n                arr.push(key);\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n        //查找字段带值 ，表单字段列，查找字段列，查询的数据\r\n    setByVal(columns, columns1, lookupById) {\r\n        const columnArr = [].concat(columns);\r\n        const column1Arr = [].concat(columns1);\r\n        if (this.attrname) {\r\n            var value = this.getValue();\r\n            if (!value) {\r\n                this.crmEntity.Controls(columnArr, 'clear');\r\n                return this;\r\n            }\r\n            lookupById(value, column1Arr).then((res, attrs) => {\r\n                for (var i = 0; i < columnArr.length; i++) {\r\n                    let attr = attrs.attributes[column1Arr[i]];\r\n                    attr !== null && (\r\n                            (new crmAttr(this.Xrm, columnArr[i])).setTypeVal(attr)\r\n                        )\r\n                }\r\n            })\r\n        }\r\n        return this\r\n    }\r\n        //待完善，有问题\r\n    setTypeVal(attr) {\r\n        const value = attr.value;\r\n        if (this.attrname) {\r\n            switch (attr.type) {\r\n            case 'a:OptionSetValue':\r\n                this.val(value);\r\n                break;\r\n            case 'a:EntityReference':\r\n                let toValue = {};\r\n                toValue.id = attr.guid;\r\n                toValue.entityType = attr.logicalName;\r\n                toValue.name = attr.name;\r\n                this.val([toValue]);\r\n                break;\r\n            case 'a:EntityCollection':\r\n                this.val(value);\r\n                break;\r\n            case 'a:Money':\r\n                this.val(value);\r\n                break;\r\n            case 'a:AliasedValue':\r\n                this.val(value);\r\n                break;\r\n            case 'c:int':\r\n                this.val(value);\r\n                break;\r\n            case 'c:decimal':\r\n                this.val(value);\r\n                break;\r\n            case 'c:dateTime':\r\n                this.val(value);\r\n                break;\r\n            case 'c:boolean':\r\n                this.val(value);\r\n                break;\r\n            default:\r\n                this.val(value);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n}\r\nexport class crmEntity {\r\n    constructor(Xrm, Sys) {\r\n        this.Xrm = Xrm;\r\n        this.Sys= Sys;\r\n    }\r\n        //获取实体Id 属性\r\n    get id() {\r\n        return this.Xrm.Page.data.entity.getId();\r\n    }\r\n        //获取实体name 属性\r\n    get name() {\r\n        return this.Xrm.Page.data.entity.getEntityName();\r\n    }\r\n        //获取实体类型 属性\r\n    get type() {\r\n        return this.Xrm.Page.ui.getFormType();\r\n    }\r\n        //获取登录人id  属性\r\n    get userid() {\r\n        return this.Xrm.Page.context.getUserId();\r\n    }\r\n        //获取登录人name 属性\r\n    get username() {\r\n        return this.Xrm.Page.context.getUserName();\r\n    }\r\n        //判断是否是当前登录人 属性\r\n    isowner() {\r\n        return this.userid == new crmAttr(this.Xrm, 'ownerid').val();\r\n    }\r\n        //保存\r\n    save() {\r\n        return this.Xrm.Page.data.save();\r\n    }\r\n        //刷新按钮\r\n    refRibbon() {\r\n        return this.Xrm.Page.ui.refreshRibbon();\r\n    }\r\n        //刷新实体\r\n    refresh() {\r\n        this.Sys && this.Sys.Application._components.crmGrid &&  this.Sys.Application._components.crmGrid.refresh();\r\n        this.Xrm.Page.data && this.Xrm.Page.data.refresh();\r\n            //this.Xrm.Utility.openEntityForm(this.Xrm.Page.data.entity.getEntityName(), this.Xrm.Page.data.entity.getId())\r\n    }\r\n    reload() {\r\n        setTimeout(() => {\r\n            this.Xrm.Utility.openEntityForm(this.Xrm.Page.data.entity.getEntityName(), this.Xrm.Page.data.entity.getId())\r\n        }, 1)\r\n    }\r\n        //禁用或启用窗体所有字段\r\n    disabledAll(state) {\r\n        this.Controls(this.Xrm.Page.ui.controls, 'disabled', state);\r\n    }\r\n        //禁用或启用\r\n    disabled(arr, state) {\r\n        this.Tabs(arr, 'disabled', state)\r\n    }\r\n        //显示\r\n    show(arr) {\r\n        this.Tabs(arr, 'show')\r\n    }\r\n        //隐藏\r\n    hide(arr) {\r\n        this.Tabs(arr, 'hide')\r\n    }\r\n        //是否没必填字段\r\n    isValid() {\r\n        return this.Xrm.Page.data.getIsValid();\r\n    }\r\n        //对tab下的字段控制\r\n    Tabs(arr, handle, state) {\r\n        const Xrm = this.Xrm;\r\n        const arrCopy = [].concat(arr);\r\n        let conArr = [].concat(arr)\r\n        arrCopy.forEach((item) => {\r\n            let tab = Xrm.Page.ui.tabs.get(item);\r\n            if (tab) {\r\n                const index = conArr.indexOf(item);\r\n                index > -1 && conArr.splice(index, 1);\r\n                if (handle === 'hide' || handle === 'show') {\r\n                    const disabled = (new crmAttr())[handle].bind({ contname: tab });\r\n                    disabled(state);\r\n                } else {\r\n                    this.Sections(tab.sections.get(), handle, state)\r\n                }\r\n            }\r\n        })\r\n        this.Sections(conArr, handle, state);\r\n    }\r\n        //对Sections下的字段控制\r\n    Sections(sections, handle, state) {\r\n        let conArr = [].concat(sections)\r\n        sections.forEach((section) => {\r\n            let sec = section;\r\n            if (typeof sec === 'string') {\r\n                sec = this.getSections(section) || sec;\r\n            }\r\n            if (typeof sec !== 'string') {\r\n                const index = conArr.indexOf(section);\r\n                index > -1 && conArr.splice(index, 1);\r\n                this.Controls(sec.controls.get(), handle, state);\r\n            }\r\n        })\r\n        this.Controls(conArr, handle, state);\r\n    }\r\n    Controls(controls, handle, state) {\r\n        controls.forEach((control) => {\r\n            if (typeof control == 'string') {\r\n                (new crmAttr(this.Xrm, control))[handle](state);\r\n            } else {\r\n                var controlType = control.getControlType();\r\n                if (controlType != 'iframe' && controlType != 'webresource' && controlType != 'subgrid') {\r\n                    const disabled = (new crmAttr())[handle].bind({ contname: control });\r\n                    disabled(state);\r\n                }\r\n            }\r\n        });\r\n    }\r\n        //获取节对象Sections\r\n    getSections(name) {\r\n        const tabs = this.Xrm.Page.ui.tabs.get();\r\n        for (let index in tabs) {\r\n            let tab = tabs[index];\r\n            const section = tab.sections.getFirst((sec) => {\r\n                return sec.getName() == name;\r\n            })\r\n            if (section) {\r\n                return section;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/common/crmEntity.js\n **/"],"sourceRoot":""}